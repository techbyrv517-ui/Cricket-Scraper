{% extends 'admin.html' %}

{% block title %}Matches - Cricbuzz Live Score{% endblock %}

{% block main_content %}
<header>
    <h1>Matches</h1>
</header>

<div class="table-container">
    <div class="series-selector">
        <label for="seriesSelect">Select Series:</label>
        <select id="seriesSelect">
            <option value="">-- Select a Series --</option>
            {% for s in all_series %}
            <option value="{{ s.id }}">{{ s.series_name }}</option>
            {% endfor %}
        </select>
    </div>
    
    <div id="matchesContent">
        <p class="placeholder-text">Please select a series to view matches</p>
    </div>
</div>

<script>
    document.getElementById('seriesSelect').addEventListener('change', function() {
        const seriesId = this.value;
        const content = document.getElementById('matchesContent');
        
        if(!seriesId) {
            content.innerHTML = '<p class="placeholder-text">Please select a series to view matches</p>';
            return;
        }
        
        content.innerHTML = '<p class="placeholder-text">Loading matches...</p>';
        
        fetch('/api/get-matches/' + seriesId)
        .then(response => response.json())
        .then(data => {
            if(data.matches.length === 0) {
                content.innerHTML = '<p class="placeholder-text">No matches found for this series</p>';
                return;
            }
            
            let html = '<h2>' + data.series.series_name + '</h2>';
            html += '<p class="series-info">' + (data.series.date_range || '') + '</p>';
            html += '<table><thead><tr><th>ID</th><th>Match ID</th><th>Match Title</th><th>Match Date</th><th>Match URL</th></tr></thead><tbody>';
            
            data.matches.forEach(m => {
                html += '<tr>';
                html += '<td>' + m.id + '</td>';
                html += '<td>' + m.match_id + '</td>';
                html += '<td>' + m.match_title + '</td>';
                html += '<td>' + (m.match_date || '-') + '</td>';
                html += '<td><a href="' + m.match_url + '" target="_blank">View Match</a></td>';
                html += '</tr>';
            });
            
            html += '</tbody></table>';
            content.innerHTML = html;
        })
        .catch(error => {
            content.innerHTML = '<p class="placeholder-text error">Error loading matches</p>';
        });
    });
</script>
{% endblock %}
